var M=Object.defineProperty;var O=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var A=(t,e,o)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,U=(t,e)=>{for(var o in e||(e={}))N.call(e,o)&&A(t,o,e[o]);if(O)for(var o of O(e))P.call(e,o)&&A(t,o,e[o]);return t};import{_ as v,r as c,o as i,c as d,a as l,b as u,w as y,d as m,e as b,f as k,F as $,t as f,g as w,h as L,i as G,j as q,k as D,l as R,m as F,n as J}from"./vendor.3b15c050.js";const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};z();const j={name:"app-header",props:[],emits:[],components:{},data(){return{}},created(){},mounted(){},methods:{},computed:{},unmounted(){}},H={class:"app-header"},K=l("h1",null,"Mister Toy",-1),Y=m("Home"),W=m("| "),Q=m("about"),X=m("| "),Z=m("Toys"),ee=m("| "),te=m("Dashboard");function oe(t,e,o,r,n,s){const a=c("router-link");return i(),d("header",H,[K,l("nav",null,[u(a,{to:"/",class:"link"},{default:y(()=>[Y]),_:1}),W,u(a,{to:"/about",class:"link"},{default:y(()=>[Q]),_:1}),X,u(a,{to:"/toy",class:"link"},{default:y(()=>[Z]),_:1}),ee,u(a,{to:"/toy/dashboard",class:"link"},{default:y(()=>[te]),_:1})])])}var ne=v(j,[["render",oe]]);const se={name:"app-footer",props:[],emits:[],components:{},data(){return{}},created(){},mounted(){},methods:{},computed:{},unmounted(){}},re={class:"app-footer"};function le(t,e,o,r,n,s){return i(),d("footer",re,"\xA9coffeeRights \u2764 SAPIR 2022")}var ie=v(se,[["render",le]]);const ae={name:"App",props:[],emits:[],components:{appHeader:ne,appFooter:ie},data(){return{}},created(){this.$store.dispatch({type:"loadToys"})},mounted(){},methods:{},computed:{isLoading(){return this.$store.getters.isLoading}},unmounted(){}},ue={key:1};function ce(t,e,o,r,n,s){const a=c("app-header"),_=c("router-view"),h=c("app-footer");return i(),d($,null,[u(a),s.isLoading?k("",!0):(i(),b(_,{key:0,class:"main-layout"})),s.isLoading?(i(),d("p",ue,"Loading...")):k("",!0),u(h)],64)}var de=v(ae,[["render",ce]]);const pe={name:"login",props:{loggedUser:String},emits:["signup","login","logout"],components:{},data(){return{user:{username:"",password:""}}},created(){},mounted(){},methods:{login(){this.$emit("login",this.user)},signup(){this.$emit("signup")},logout(){this.$emit("logout")}},computed:{},unmounted(){}},me={key:0,class:"login"},_e=l("h4",null,"Login",-1),ye=m("Login"),he=m("Sign-up"),ge={key:1,class:"login"},fe=m("Logout");function ve(t,e,o,r,n,s){const a=c("el-input"),_=c("el-button");return i(),d($,null,[o.loggedUser?k("",!0):(i(),d("section",me,[_e,l("form",null,[u(a,{type:"text",modelValue:n.user.username,"onUpdate:modelValue":e[0]||(e[0]=h=>n.user.username=h),placeholder:"Enter username"},null,8,["modelValue"]),u(a,{type:"password",modelValue:n.user.password,"onUpdate:modelValue":e[1]||(e[1]=h=>n.user.password=h),placeholder:"Enter password"},null,8,["modelValue"]),u(_,{onClick:s.login,type:"primary"},{default:y(()=>[ye]),_:1},8,["onClick"])]),u(_,{onClick:s.signup,type:"success"},{default:y(()=>[he]),_:1},8,["onClick"])])),o.loggedUser?(i(),d("section",ge,[l("h1",null,"hello "+f(o.loggedUser),1),u(_,{onClick:s.logout,type:"danger"},{default:y(()=>[fe]),_:1},8,["onClick"])])):k("",!0)],64)}var be=v(pe,[["render",ve]]);const $e={name:"sign-up",props:[],emits:["signup"],components:{},data(){return{user:{fullname:"",username:"",password:""}}},created(){},mounted(){},methods:{signup(){console.log("signup"),this.$emit("signup")}},computed:{},unmounted(){}},ke={class:"sign-up"},we=l("h4",null,"Sign-up",-1),Te=m("Sign-up");function Se(t,e,o,r,n,s){const a=c("el-input"),_=c("el-button");return i(),d("section",ke,[we,l("form",null,[u(a,{type:"text",modelValue:n.user.fullname,"onUpdate:modelValue":e[0]||(e[0]=h=>n.user.fullname=h),placeholder:"Enter fullname"},null,8,["modelValue"]),u(a,{type:"text",modelValue:n.user.username,"onUpdate:modelValue":e[1]||(e[1]=h=>n.user.username=h),placeholder:"Enter username"},null,8,["modelValue"]),u(a,{type:"password",modelValue:n.user.password,"onUpdate:modelValue":e[2]||(e[2]=h=>n.user.password=h),placeholder:"Enter password"},null,8,["modelValue"]),u(_,{onClick:s.signup,type:"success"},{default:y(()=>[Te]),_:1},8,["onClick"])])])}var Le=v($e,[["render",Se]]),Ve="/assets/toys.8ff2b3cd.svg";const xe={name:"home-page",props:[],emits:[],components:{login:be,signUp:Le},data(){return{isSignup:!1}},mounted(){},methods:{signup(){this.isSignup=!this.isSignup},login(t){console.log(t),this.$store.dispatch({type:"login",user:t})},logout(){this.$store.commit({type:"logout"})}},computed:{user(){return this.$store.getters.getUsername}},unmounted(){}},Be={class:"home-page"},Ue=l("img",{src:Ve},null,-1);function Ce(t,e,o,r,n,s){const a=c("login"),_=c("sign-up");return i(),d("section",Be,[Ue,n.isSignup?k("",!0):(i(),b(a,{key:0,onLogin:s.login,onSignup:s.signup,onLogout:s.logout},null,8,["onLogin","onSignup","onLogout"])),n.isSignup&&!s.user?(i(),b(_,{key:1,onSignup:s.signup},null,8,["onSignup"])):k("",!0)])}var Ie=v(xe,[["render",Ce]]);const Ee={name:"about",props:[],emits:[],components:{},data(){return{center:{lat:32.088179,lng:34.790144},locs:[{name:"Tel Aviv",func:this.updateLoc,pos:{lat:32.088179,lng:34.790144}},{name:"Ramat Gan",func:this.updateLoc,pos:{lat:32.066278,lng:34.830301}},{name:"Petach Tikva",func:this.updateLoc,pos:{lat:32.093869,lng:34.882401}}],markers:[{position:{lat:32.088179,lng:34.790144}},{position:{lat:32.066278,lng:34.830301}},{position:{lat:32.093869,lng:34.882401}}]}},created(){},mounted(){},methods:{updateLoc({lat:t,lng:e}){console.log(t,e),this.center={lat:t,lng:e}}},computed:{},unmounted(){}},Oe={class:"about"},Ae=l("div",{class:"text-container"},[l("h1",null,"about"),l("p",null,"Gary Grant found employment in the 1970s at a local bike shop in Amersham, his hometown. His natural talent for buying and selling flourished when he recognised a new craze for customised skateboards, so he started selling skateboard accessories while he was still working at the bike shop. The owner of the bike shop was suitably unimpressed that the majority of calls into the store were for Gary and so Gary was let go, set free to start up on his own.")],-1),Me={class:"btn-container"};function Ne(t,e,o,r,n,s){const a=c("GMapMarker"),_=c("GMapCluster"),h=c("GMapMap"),p=c("el-button");return i(),d("section",Oe,[Ae,u(h,{center:n.center,zoom:12,"map-type-id":"terrain",style:{width:"500px",height:"300px"}},{default:y(()=>[u(_,null,{default:y(()=>[(i(!0),d($,null,w(n.markers,(g,E)=>(i(),b(a,{key:E,position:g.position,clickable:!0,draggable:!1,onClick:io=>n.center=g.position},null,8,["position","onClick"]))),128))]),_:1})]),_:1},8,["center"]),l("div",Me,[(i(!0),d($,null,w(n.locs,g=>(i(),b(p,{key:g.name,type:"success",size:"large",onClick:E=>g.func(g.pos)},{default:y(()=>[m(f(g.name),1)]),_:2},1032,["onClick"]))),128))])])}var Pe=v(Ee,[["render",Ne]]);const Ge={name:"toy-filter",props:[],emits:[],components:{},data(){return{filterBy:{name:"",inStock:"",labels:[],sortBy:"Time"},stockOptions:[{label:"All",value:""},{label:"In stock",value:!0},{label:"Out stock",value:!1}],labelOptions:["On wheels","Box game","Art","Baby","Doll","Puzzle","Outdoor","Battery Powered"],sortOptions:["Time","Name","Price"]}},created(){},mounted(){},methods:{},computed:{},unmounted(){}},qe={class:"toy-filter"},De=m(" Stock: "),Re=m(" Labels: "),Fe=m(" Sort By: ");function Je(t,e,o,r,n,s){const a=c("el-input"),_=c("el-option"),h=c("el-select");return i(),d("section",qe,[u(a,{class:"w-50 m-2 input",type:"text",placeholder:"Search toy..",modelValue:n.filterBy.name,"onUpdate:modelValue":e[0]||(e[0]=p=>n.filterBy.name=p)},null,8,["modelValue"]),l("label",null,[De,u(h,{class:"select",modelValue:n.filterBy.inStock,"onUpdate:modelValue":e[1]||(e[1]=p=>n.filterBy.inStock=p)},{default:y(()=>[(i(!0),d($,null,w(n.stockOptions,p=>(i(),b(_,{key:p.label,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("label",null,[Re,u(h,{class:"select",modelValue:n.filterBy.labels,"onUpdate:modelValue":e[2]||(e[2]=p=>n.filterBy.labels=p),multiple:"",placeholder:"Select"},{default:y(()=>[(i(!0),d($,null,w(n.labelOptions,p=>(i(),b(_,{key:p,label:p,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("label",null,[Fe,u(h,{class:"select",modelValue:n.filterBy.sortBy,"onUpdate:modelValue":e[3]||(e[3]=p=>n.filterBy.sortBy=p)},{default:y(()=>[(i(!0),d($,null,w(n.sortOptions,p=>(i(),b(_,{key:p,label:p,value:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])}var ze=v(Ge,[["render",Je]]);const je={name:"toy-preview",props:{toy:Object},emits:["removeToy"],components:{},data(){return{}},created(){},mounted(){},methods:{goToEdit(){this.$router.push(`/toy/edit/${this.toy._id}`)},removeToy(){this.$emit("removeToy",this.toy._id)},goToDetail(){this.$router.push(`/toy/${this.toy._id}`)}},computed:{},unmounted(){}},He={class:"toy-preview"},Ke=l("span",null,"Name:",-1),Ye=l("span",null,"Price:",-1),We=l("span",null,"inStock:",-1),Qe={class:"btn-container"},Xe=m("edit"),Ze=m("details"),et=m("delete");function tt(t,e,o,r,n,s){const a=c("el-button");return i(),d("li",He,[l("b",null,[Ke,m(" "+f(o.toy.name),1)]),l("p",null,[Ye,m(" "+f(o.toy.price),1)]),l("p",null,[We,m(" "+f(o.toy.inStock),1)]),l("div",Qe,[u(a,{onClick:s.goToEdit,type:"primary"},{default:y(()=>[Xe]),_:1},8,["onClick"]),u(a,{onClick:s.goToDetail,type:"primary"},{default:y(()=>[Ze]),_:1},8,["onClick"]),u(a,{onClick:s.removeToy,type:"danger"},{default:y(()=>[et]),_:1},8,["onClick"])])])}var ot=v(je,[["render",tt]]);const nt={name:"toy-list",props:{toys:Array},emits:["removeToy"],components:{toyPreview:ot},data(){return{}},created(){},mounted(){},methods:{removeToy(t){this.$emit("removeToy",t)}},computed:{},unmounted(){}},st={class:"toy-list list-layout"};function rt(t,e,o,r,n,s){const a=c("toy-preview");return i(),d("ul",st,[(i(!0),d($,null,w(o.toys,_=>(i(),b(a,{toy:_,key:_._id,onRemoveToy:s.removeToy},null,8,["toy","onRemoveToy"]))),128))])}var lt=v(nt,[["render",rt]]);const it={name:"toy-app",props:[],emits:[],components:{toyFilter:ze,toyList:lt},data(){return{}},created(){},mounted(){},methods:{goAdd(){this.$router.push("/toy/edit")},removeToy(t){this.$store.dispatch({type:"removeToy",id:t})}},computed:{toys(){return this.$store.getters.toys},isLoading(){return this.$store.getters.isLoading}},unmounted(){}},at={class:"toy-app"},ut=m("Add new toy"),ct={key:0};function dt(t,e,o,r,n,s){const a=c("toy-filter"),_=c("el-button"),h=c("toy-list");return i(),d("section",at,[u(a),u(_,{class:"btn",onClick:e[0]||(e[0]=p=>s.goAdd()),type:"primary",round:""},{default:y(()=>[ut]),_:1}),s.isLoading?(i(),d("p",ct,"Loading...")):k("",!0),u(h,{toys:s.toys,onRemoveToy:s.removeToy},null,8,["toys","onRemoveToy"])])}var pt=v(it,[["render",dt]]);const mt={query:S,get:_t,post:yt,put:gt,remove:ft,postMany:ht,checkLogin:vt};function S(t,e=1500){var o=JSON.parse(localStorage.getItem(t))||[];return new Promise((r,n)=>{setTimeout(()=>{r(o)},e)})}function _t(t,e){return S(t).then(o=>o.find(r=>r._id===e))}function yt(t,e){return e._id=bt(),S(t).then(o=>(o.push(e),B(t,o),e))}function ht(t,e){return S(t).then(o=>(o.push(...e),B(t,o),o))}function gt(t,e){return S(t).then(o=>{const r=o.findIndex(n=>n._id===e._id);return o.splice(r,1,e),B(t,o),e})}function ft(t,e){return S(t).then(o=>{const r=o.findIndex(n=>n._id===e);if(r===-1)return Promise.reject(`Unknown Entity ${t} with Id: ${e}`);o.splice(r,1),B(t,o)})}function vt(t,e){var o=gUsers.find(r=>r.username===t&&r.password===e);return o?(o=U({},o),delete o.password,Promise.resolve(o)):Promise.reject("Invalid Credentials")}function B(t,e){localStorage.setItem(t,JSON.stringify(e))}function bt(t=8){for(var e="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e+=o.charAt(Math.floor(Math.random()*o.length));return e}const I={saveToStorage:$t,loadFromStorage:kt,makeId:wt};function $t(t,e){localStorage.setItem(t,JSON.stringify(e)||null)}function kt(t){let e=localStorage.getItem(t);return e?JSON.parse(e):void 0}function wt(t=8){for(var e="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e+=o.charAt(Math.floor(Math.random()*o.length));return e}const V="/api/toy/",T={query:Tt,getById:St,remove:Vt,save:Lt,getEmptyToy:xt};async function Tt(t){console.log("qurey");try{const e=await L.get(V,{params:t});return console.log("toys",e.data),e.data}catch(e){throw console.log("query err",e),e}}async function St(t){try{return(await L.get(V+t)).data}catch(e){throw console.log("getById err",e),e}}async function Lt(t){try{var e="";return t._id?e=await L.put(V+t._id,t):e=await L.post(V,t),e.data}catch(o){throw console.log("save err",o),o}}async function Vt(t){try{return(await L.delete(V+t)).data}catch(e){throw console.log("remove err",e),e}}function xt(){return{name:"",price:0,labels:[],createdAt:Date.now(),inStock:!0,reviews:["Good","Nice","Fun"]}}const Bt={name:"toy-details",props:[],emits:[],components:{},data(){return{toy:null}},created(){const{id:t}=this.$route.params;T.getById(t).then(e=>{console.log(e),this.toy=e})},mounted(){},methods:{},computed:{},unmounted(){}},Ut={key:0,class:"toy-details"},Ct=l("hr",null,null,-1),It=l("b",null,"review:",-1),Et=m("Add new review");function Ot(t,e,o,r,n,s){const a=c("el-button");return n.toy?(i(),d("section",Ut,[l("div",null,[l("h1",null,"name: "+f(n.toy.name),1),l("p",null,"id: "+f(n.toy._id),1),l("p",null,"price: "+f(n.toy.price),1),l("p",null,"type: "+f(n.toy.type),1),l("p",null,"createdAt: "+f(n.toy.createdAt),1),l("p",null,"inStock: "+f(n.toy.inStock),1),Ct,It,(i(!0),d($,null,w(n.toy.reviews,_=>(i(),d("p",null,f(_),1))),256)),u(a,{type:"primary",round:""},{default:y(()=>[Et]),_:1})])])):k("",!0)}var At=v(Bt,[["render",Ot]]);const Mt={name:"toy-edit",props:[],emits:[],components:{},data(){return{toyToEdit:null,options:["On wheels","Box game","Art","Baby","Doll","Puzzle","Outdoor","Battery Powered"]}},created(){this.toyId?(async()=>{const t=await T.getById(this.toyId);this.toyToEdit=t})():this.toyToEdit=T.getEmptyToy()},mounted(){},methods:{saveToy(){console.log("frist saveToy",this.toyToEdit),this.$store.dispatch({type:"saveToy",toy:this.toyToEdit}),this.$router.push("/toy")},goBack(){this.$router.push("/toy")}},computed:{toyId(){return this.$route.params.id},title(){return this.toyId?"Toy Edit":"Toy Add"}},unmounted(){}},Nt={key:0,class:"toy-edit"},Pt={class:"form"},Gt={class:"form-control"},qt=l("label",{for:"txt",class:"form-label"},"Toy name:",-1),Dt={class:"form-control"},Rt=l("label",{for:"speed",class:"form-label"},"Toy price:",-1),Ft={class:"btn-group"},Jt=l("br",null,null,-1),zt=m("save"),jt=m("go back");function Ht(t,e,o,r,n,s){const a=c("el-input"),_=c("el-option"),h=c("el-select"),p=c("el-button");return n.toyToEdit?(i(),d("section",Nt,[l("h1",null,f(s.title),1),l("pre",null,f(n.toyToEdit),1),l("form",Pt,[l("div",Gt,[qt,u(a,{required:"",modelValue:n.toyToEdit.name,"onUpdate:modelValue":e[0]||(e[0]=g=>n.toyToEdit.name=g),id:"txt",type:"text",class:"form-input input",placeholder:"Enter your toy name here..."},null,8,["modelValue"])]),l("div",Dt,[Rt,u(a,{required:"",modelValue:n.toyToEdit.price,"onUpdate:modelValue":e[1]||(e[1]=g=>n.toyToEdit.price=g),modelModifiers:{number:!0},id:"price",type:"number",class:"form-input input"},null,8,["modelValue"])]),u(h,{class:"select",multiple:"",modelValue:n.toyToEdit.labels,"onUpdate:modelValue":e[2]||(e[2]=g=>n.toyToEdit.labels=g),placeholder:"Select"},{default:y(()=>[(i(!0),d($,null,w(n.options,g=>(i(),b(_,{key:g,label:g,value:g},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l("div",Ft,[Jt,u(p,{onClick:s.saveToy,class:"btn btn-info"},{default:y(()=>[zt]),_:1},8,["onClick"])])]),u(p,{onClick:s.goBack,class:"btn"},{default:y(()=>[jt]),_:1},8,["onClick"])])):k("",!0)}var Kt=v(Mt,[["render",Ht]]);const Yt={name:"dashboard",props:[],emits:[],components:{},data(){return{}},created(){},mounted(){},methods:{},computed:{},unmounted(){}},Wt={class:"dashboard"};function Qt(t,e,o,r,n,s){return i(),d("section",Wt,"dashboard")}var Xt=v(Yt,[["render",Qt]]);const Zt=G({history:q("/"),routes:[{path:"/",name:"home",component:Ie},{path:"/about",name:"about",component:Pe},{path:"/toy",name:"toy",component:pt},{path:"/toy/:id",name:"toy-details",component:At},{path:"/toy/edit/:id?",name:"toy-edit",component:Kt},{path:"/toy/dashboard",name:"toy-dashboard",component:Xt}]}),eo="usersDB",C={checkLogin:to,logout:no,getLoggedinUser:oo};function to({username:t,password:e}){return mt.query(eo).then(o=>{var r=o.find(n=>n.username===t&&n.password===e);if(!r)throw"Invalid Credentials";return I.saveToStorage("loggedinUser",r),r=U({},r),r})}function oo(){return I.loadFromStorage("loggedinUser")}function no(){I.saveToStorage("loggedinUser",{fullname:null,username:null,password:null,isAdmin:null})}const so={state:{user:C.getLoggedinUser()},getters:{getUsername(t){return JSON.parse(JSON.stringify(t.user))}},mutations:{setLoggedinUser(t,{user:e}){t.user=e},logout(t){C.logout(),t.user={username:"",password:""}}},actions:{async login(t,{user:e}){console.log(e);try{const o=await C.checkLogin(e);t.commit({type:"setLoggedinUser",user:o})}catch(o){console.log("login",o)}}}},ro={state:{toys:[],filterBy:null,isLoading:!1},getters:{isLoading(t){return t.isLoading},toys(t){return JSON.parse(JSON.stringify(t.toys))}},mutations:{setIsLoading(t,{isLoading:e}){console.log("isLoading",e),t.isLoading=e},setToys(t,{toys:e}){t.toys=e},saveToy(t,{getToy:e}){const o=e,r=t.toys.findIndex(n=>n._id===o._id);r!==-1?t.toys.splice(r,1,o):t.toys.unshift(o),console.log(t.toys)},removeToy(t,{id:e}){const o=t.toys.findIndex(r=>r._id===e);t.toys.splice(o,1)}},actions:{async loadToys(t){t.commit({type:"setIsLoading",isLoading:!0});try{const e=await T.query();t.commit({type:"setToys",toys:e})}catch(e){console.log("loadToys err",e)}finally{t.commit({type:"setIsLoading",isLoading:!1})}},async saveToy({commit:t},{toy:e}){t({type:"setIsLoading",isLoading:!0});try{const o=await T.save(e);console.log(o),t({type:"saveToy",getToy:o})}catch(o){console.log("saveToy err",o)}finally{t({type:"setIsLoading",isLoading:!1})}},async removeToy({commit:t},{id:e}){try{const o=await T.remove(e);t({type:"removeToy",id:e})}catch(o){console.log("removeToy err",o)}}}},lo=D({strict:!0,state:{},getters:{},mutations:{},actions:{},modules:{userStore:so,toyStore:ro}});const x=R(de);x.use(F,{load:{key:""}});x.use(J);x.use(Zt);x.use(lo);x.mount("#app");
